<!DOCTYPE html>
<title>media</title>
<link rel="stylesheet" href="file:///home/tz/.config/rucola/default_dark.css">
<!-- raw HTML omitted -->
<ul>
<li><a href=".html">图片</a></li>
<li><a href=".html">视频</a></li>
<li><a href=".html">动效</a></li>
<li><a href=".html">WebRTC</a></li>
</ul>
<!-- raw HTML omitted -->
<h1>图片</h1>
<ul>
<li>
<p><a href="https://cloud.tencent.com/developer/article/2251826">腾讯云开发者：这个开发者易忽略的优化点，腾讯视频竟靠它省上千万元</a></p>
<ul>
<li>
<p>图片压缩：</p>
<ul>
<li>
<p>无损压缩：和其它数据文件的压缩一样，是对文件的数据存储方式进行优化。采用某种算法表示重复的数据信息，文件可以完全还原，不会影响文件内容。</p>
<ul>
<li>
<p>原理：是相同的颜色信息只需保存一次。压缩图像的软件首先会确定图像中哪些区域是相同的，哪些是不同的。包括了重复数据的图像(如蓝天) 就可以被压缩，只有蓝天的起始点和终结点需要被记录下来。但是蓝色可能还会有不同的深浅，天空有时也可能被树木、山峰或其他的对象掩盖，这些就需要另外记录。</p>
</li>
<li>
<p>常用算法：游程编码、熵编码法：如 LZW 这样的自适应字典算法。</p>
</li>
</ul>
</li>
<li>
<p>有损压缩：在保存图像时保留了较多的亮度信息，而将色相和色纯度的信息和周围的像素进行合并。合并的比例不同，压缩的比例也不同，由于信息量减少了，所以压缩比可以很高，图像质量也会相应下降。</p>
<ul>
<li>
<p>原理：人的眼睛对光线比较敏感，光线对景物的作用比颜色的作用更为重要</p>
</li>
<li>
<p>常用算法：</p>
<ul>
<li>色彩空间：这是化减到图像中常用的颜色。所选择的颜色定义在压缩图像头的调色板中，图像中的每个像素都用调色板中颜色索引表示。这种方法可以与抖动一起使用以模糊颜色边界。</li>
<li>色度抽样：这利用了人眼对于亮度变化的敏感性远大于颜色变化，这样就可以将图像中的颜色信息减少一半甚至更多。</li>
<li>变换编码：这是最常用的方法。首先使用如离散余弦变换（DCT）或者小波变换这样的傅立叶相关变换，然后进行量化和用熵编码法压缩。</li>
<li>分形压缩：是一种以碎形为基础的图像压缩，适用于纹理及一些自然影像。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>| 常用格式 | 特点                                                                                                                                                    |
|----------|---------------------------------------------------------------------------------------------------------------------------------------------------------|
| gif      | Alpha 通道只有 1 bit，这意味着一个像素只能是完全透明或者完全不透明，会有毛边效果。                                                                      |
| png      | 设计目的是替代 GIF 格式，采用 LZ77 算法的派生算法进行压缩，相对于 JPEG 和 GIF 来说，它最大的优势在于支持完整的透明通道。可以为原图像定义 256 个透明层次 |
| jpg/jpeg | 有损压缩                                                                                                                                                |
| webp     | 以更高的压缩比替代 JPEG。它用 VP8 视频帧内编码作为其算法基础，拥有很不错的压缩效果，同时提供了有损压缩与无损压缩                                        |
| sharpp   | 腾讯音视频实验室自研的基于新一代视频编码标准H.265的图片压缩技术。                                                                                       |
| avif     | 基于 AV1 视频编码的新图像格式。相对于JPEG，WEBP 这类图片格式来说，它的压缩率更高，并且画面细节更好。                                                    |</p>
<p><img src="./Pictures/media/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E5%8E%8B%E7%BC%A9%E7%8E%87%E5%AF%B9%E6%AF%94.avif" alt="image" /></p>
</li>
</ul>
</li>
</ul>
<h1>视频</h1>
<ul>
<li>
<p><a href="https://cloud.tencent.com/developer/article/2058320">腾讯多媒体实验室：浅入浅出谈“视频压缩”</a></p>
</li>
<li>
<p><a href="https://cloud.tencent.com/developer/article/1691027">腾讯大讲堂：【客户端技术】深入了解视频播放器工作原理与实现</a></p>
</li>
</ul>
<h1>动效</h1>
<ul>
<li>
<p><a href="https://cloud.tencent.com/developer/article/2039422">产品介绍｜PAG：消除动效研发成本</a></p>
</li>
<li>
<p><a href="https://www.163.com/dy/article/I1GNB8IE0518R7MO.html">腾讯技术工程：微信、QQ 等600+业务都在用的PAG动效方案揭秘</a></p>
<ul>
<li>
<p>传统的动效方案：依赖研发用代码还原动效的生产方式存在巨大的瓶颈
<img src="./Pictures/media/%E5%8A%A8%E6%95%88-%E4%BC%A0%E7%BB%9F%E5%B7%A5%E4%BD%9C%E6%B5%81.avif" alt="image" /></p>
<ul>
<li>
<p>1.研发成本高：每个动效都需要研发通过代码来还原，单独排期的特效以及手工配置还原的过程，都需要大量的研发人力持续投入。由于研发人力有限，也导致这个流程无法批量化生产素材。</p>
</li>
<li>
<p>2.生产周期长：设计师和研发人员的联调成本高，效果还原度需要反复确认。之前生产一个典型的视频模板，平均需要研发投入 5 人天还原才能上线。这样很难跟上运营节奏，容易错过时事热点。</p>
</li>
<li>
<p>3.视觉动效弱：AE 里有很多复杂动效，使用纯代码还原起来非常困难，设计师只能不断简化效果以达到跟开发成本的平衡。导致最终上线的视觉效果都是打折过的，往往达不到预期。</p>
</li>
</ul>
</li>
<li>
<p>腾讯的PAG 的动效方案：降低或消除动效相关的研发成本，打通设计师创作到素材上线的自动化流程。
<img src="./Pictures/media/%E5%8A%A8%E6%95%88-%E8%85%BE%E8%AE%AF%E6%96%B9%E6%A1%88.avif" alt="image" /></p>
<ul>
<li>
<p>1.研发成本方面：在 PAG 的动效工作流里，研发只有一次性接入 SDK 的成本，在后续整个素材生产流程都无需研发人力介入。整套工作流不在受制于研发的人力瓶颈，就能够开放给更多的设计师使用，批量化的进行素材生产。</p>
</li>
<li>
<p>2.生产周期方面：由于砍掉了研发成本，最耗时的研发和设计的联调环节也不存在了。设计师可以所见即所得地生产素材，极大地缩短了生产周期，视频模板平均生产耗时从一周可以降低到四个小时，能够快速响应运营热点。</p>
</li>
<li>
<p>3.视觉动效方面：PAG 的 SDK 已经完全还原了 AE 整个动效的渲染系统，接入一次，设计师就可以充分利用 AE 动效的原子能力，组合出无限的视觉动效，不用因为代码还原成本的问题而打折扣。</p>
</li>
</ul>
</li>
<li>
<p>应用：</p>
<ul>
<li>微信视频号的直播，所有的礼物动效</li>
<li>王者荣耀以及和平精英的高光时刻战报</li>
</ul>
</li>
<li>
<p>文件格式：二进制存储，而不是json</p>
<ul>
<li>压缩率：二进制数据结构可以跳过 Key 的内容，只存储 Value，这样也能节省大量空间。</li>
<li>版本升级：每个 PAG 文件都由无数个互相独立的 TAG 组成，扩展格式只需新增 TAG 即可。高版本 SDK 可以识别低版本所有的 TAG，低版本 SDK 遇到无法识别的 TAG 会跳过读取</li>
</ul>
</li>
<li>
<p>矢量和序列帧的混合的，所有的 AE 特性的导出：</p>
<ul>
<li>
<p>矢量导出：优势就是文件极小，并且可以运行时编辑动效的内容。但这种方式注定无法支持所有 AE 特性</p>
</li>
<li>
<p>矢量和序列帧的混合导出：设计师可以主动标记哪些图层使用序列帧导出，例如不需要编辑并且有复杂的动效，而需要编辑的图层继续用简单的矢量方式导出。从而实现支持所有的 AE 特性又能保持运行时的编辑性。</p>
<ul>
<li>
<p>视频序列帧 代替 图片序列帧：
<img src="./Pictures/media/%E5%8A%A8%E6%95%88-%E7%9F%A2%E9%87%8F%E5%92%8C%E5%BA%8F%E5%88%97%E5%B8%A7%E7%9A%84%E6%B7%B7%E5%90%88%E5%AF%BC%E5%87%BA.avif" alt="image" /></p>
<ul>
<li>
<p>优点：</p>
<ul>
<li>视频序列帧比图片小98.7%</li>
<li>视频序列帧可以利用硬件加速解码</li>
</ul>
</li>
<li>
<p>缺点：不支持透明通道。</p>
<ul>
<li>解决方法：在导出时，会将一张 RGBA 的截图扩展成两倍大小的不透明图片，左边放置 RGB 的内容，右边放置表示 Alpha 的灰度图。最后渲染时再合并回 RGBA 的图片，从而实现透明通道的支持。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>渲染：利用自定义数据结构记录额外的静态区间信息，直接让解码器跳过</p>
<ul>
<li>大部分的动效素材，实际上并不是整个时间轴都在变化的，或多或少会存在一些画面静止的区间。虽然这些静态区间数据不影响文件大小，但传给硬件解码器都会造成固定的解码器等待。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1>WebRTC</h1>
<ul>
<li><a href="https://im.iamtsm.cn/">在线体验webrtc</a></li>
</ul>
